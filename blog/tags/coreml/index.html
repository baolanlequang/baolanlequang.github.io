<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">One post tagged with &quot;coreml&quot; | baolan2005</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://baolan2005.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://baolan2005.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://baolan2005.com/blog/tags/coreml"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-adsense-account" content="ca-pub-2297027240894987"><meta data-rh="true" property="og:title" content="One post tagged with &quot;coreml&quot; | baolan2005"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://baolan2005.com/blog/tags/coreml"><link data-rh="true" rel="alternate" href="https://baolan2005.com/blog/tags/coreml" hreflang="en"><link data-rh="true" rel="alternate" href="https://baolan2005.com/blog/tags/coreml" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="baolan2005 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="baolan2005 Atom Feed">



<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2297027240894987" async crossorigin="anonymous"></script><link rel="stylesheet" href="/assets/css/styles.d9838e2a.css">
<script src="/assets/js/runtime~main.4af067f3.js" defer="defer"></script>
<script src="/assets/js/main.7cdc17ef.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a><a class="navbar__item navbar__link" href="/publications">Publication</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://jobsuch.baolan2005.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Tìm việc ở Đức<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://jobsuch.baolan2005.com/lidvn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Ôn thi Leben in Deutschland (Quốc tịch) song ngữ Đức - Việt<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/baolanlequang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.linkedin.com/in/lan-le-a036368a" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/using-core-ml-in-ios-from-a-to-z">Using Core ML in iOS from A to Z</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><header class="margin-bottom--xl"><h1>One post tagged with &quot;coreml&quot;</h1><a href="/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Core ML (Core Machine Learning) has been released by Apple in iOS 11. There are many articles about “How to using Core ML in iOS”. However, in those articles, authors just told “How to USING the created model” but they didn’t talk “How to CREATE a model”, so I write this article to introduce how to using Core ML from scratch, include how to create a model by yourself."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/using-core-ml-in-ios-from-a-to-z">Using Core ML in iOS from A to Z</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2017-10-19T00:00:00.000Z" itemprop="datePublished">October 19, 2017</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://baolan2005.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9006482?v=4" alt="Lan Le" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://baolan2005.com" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Lan Le</span></a></div><small class="avatar__subtitle" itemprop="description">Software engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Core ML (Core Machine Learning) has been released by Apple in iOS 11. There are many articles about “How to using Core ML in iOS”. However, in those articles, authors just told “How to USING the created model” but they didn’t talk “How to CREATE a model”, so I write this article to introduce how to using Core ML from scratch, include how to create a model by yourself.</p>
<p>Let’s start!</p>
<p>You can download the dataset that I use in this article <a href="https://drive.google.com/file/d/0BycvTb1uT3G0M0F5czA4YkVCcnc/view?usp=sharing" target="_blank" rel="noopener noreferrer">here</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="i-the-dataset">I. The dataset<a href="#i-the-dataset" class="hash-link" aria-label="Direct link to I. The dataset" title="Direct link to I. The dataset">​</a></h2>
<p>In this dataset, we have 5 fields: UserID, Gender, Age, EstimatedSalary, Purchased. From this dataset, I want to create a simple DSS (Decision Support System) is: <em>Decide to purchase or not by using Age and Estimated Salary.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ii-create-training-model">II. Create training model<a href="#ii-create-training-model" class="hash-link" aria-label="Direct link to II. Create training model" title="Direct link to II. Create training model">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-preparing">1. Preparing<a href="#1-preparing" class="hash-link" aria-label="Direct link to 1. Preparing" title="Direct link to 1. Preparing">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="11-python">1.1. Python<a href="#11-python" class="hash-link" aria-label="Direct link to 1.1. Python" title="Direct link to 1.1. Python">​</a></h4>
<p>Check your python version by using this command:</p>
<p><code>python — version</code></p>
<p>The reason we need to check python version because we need python version <code>2.7</code>, if your python is version above <code>3.0</code>, you need to install python version <code>2.7</code>.</p>
<p><strong>Why?</strong> I’ll talk in next section.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="12-install-coremltools">1.2. Install coremltools<a href="#12-install-coremltools" class="hash-link" aria-label="Direct link to 1.2. Install coremltools" title="Direct link to 1.2. Install coremltools">​</a></h4>
<p>Apple has provided a tool has name <code>coremltools</code> to convert a model has been created by python to model that can use in iOS.</p>
<p>coremltools only run with python version 2.7, that is the reason I told you install python 2.7 in previous section. In past, my machine has python 3.6 so I can’t using coremltools.</p>
<p>If your machine only has python 2.7, just open the terminal and enter:</p>
<p><code>pip install coremltools</code></p>
<p>If your machine has both python 3.x and python 2.7, open the terminal and enter:</p>
<p><code>sudo pip2 install coremltools</code></p>
<p>For more details about install <a href="https://apple.github.io/coremltools/" target="_blank" rel="noopener noreferrer">coremltools</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="13-install-other-packages-for-machine-learning">1.3. Install other packages for machine learning<a href="#13-install-other-packages-for-machine-learning" class="hash-link" aria-label="Direct link to 1.3. Install other packages for machine learning" title="Direct link to 1.3. Install other packages for machine learning">​</a></h4>
<p>Depend of your machine learning method, you need other packages, just visit <a href="https://apple.github.io/coremltools/" target="_blank" rel="noopener noreferrer">https://apple.github.io/coremltools/</a> for more details.</p>
<p>In this article, we need these packages: <code>sklearn</code>, <code>numpy</code>, <code>pandas</code> (Google for how to install these packages).</p>
<p><strong>Note: Install these packages with python 2.7</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-the-model-by-python">2. Create the model by python<a href="#2-create-the-model-by-python" class="hash-link" aria-label="Direct link to 2. Create the model by python" title="Direct link to 2. Create the model by python">​</a></h3>
<p>For example, I use Linear SVM and I create a python file has name svm.py with content:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pickle</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To read dataset from dataset file, continue with svm.py:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Import dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">‘Social_Network_Ads</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">csv’</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Read data from Age, EstimatedSalary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">iloc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Read data from Purchased</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">iloc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because values of Age and EstimatedSalary have a large gap so we need to standardize them to a same field to avoid wrong result.</p>
<p><strong>Why? I couldn&#x27;t answer here because it&#x27;s about another domain: <code>MACHINE LEARNING</code>. So you need to read about machine learning to understand why.</strong></p>
<p>Continue with svm.py:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Feature Scaling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preprocessing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> StandardScaler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> StandardScaler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Create the classifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> svm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">classsifier </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SVC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kernel</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">’linear’</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">classsifier</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#save the model to disk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">externals </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> joblib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filename </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ‘Social_Network_Ads_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sav’</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pickle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dump</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">classsifier</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ‘wb’</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, open your terminal and enter:</p>
<p><code>python svm.py</code></p>
<p>If you have both python 3.x and python 2.7:</p>
<p><code>python2.7 svm.py</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-create-model-for-core-ml">3. Create model for Core ML<a href="#3-create-model-for-core-ml" class="hash-link" aria-label="Direct link to 3. Create model for Core ML" title="Direct link to 3. Create model for Core ML">​</a></h3>
<p>Create another file has name extract_model.py with content:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> coremltools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">externals </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> joblib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Load the created model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">classifier </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> joblib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">‘Social_Network_Ads_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sav’</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Convert the created model to Core ML model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">coremlModel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> coremltools</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">converters</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">convert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">classifier</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">“Age”</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">”EstimatedSalary”</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">”Purchased”</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Save the converted model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">coremlModel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">save</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">‘SocialNetworkAds</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mlmodel’</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="iii-using-the-model">III. Using the model<a href="#iii-using-the-model" class="hash-link" aria-label="Direct link to III. Using the model" title="Direct link to III. Using the model">​</a></h2>
<p>I create a demo project has name <code>DemoAI</code> look like:</p>
<p><img decoding="async" loading="lazy" alt="DemoAI screenshot" src="data:image/webp;base64,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" width="311" height="552" class="img_ev3q"></p>
<p>Drag and drop file SocialNetworkAds.mlmodel to project, select this file we will see:</p>
<p><img decoding="async" loading="lazy" alt="Xcode screenshot" src="/assets/images/screenshot_2-bcab85f6c01b2f17f3037c70c021b2b8.webp" width="911" height="533" class="img_ev3q"></p>
<p>Look at section <code>Model Class</code>, check the Target Membership box if you don’t see the message <code>Swift generated source</code></p>
<p><img decoding="async" loading="lazy" alt="Xcode screenshot 2" src="data:image/webp;base64,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" width="262" height="101" class="img_ev3q"></p>
<p>Xcode will generate a Object with name is the name of model file that we have imported to project.</p>
<p>Open <code>ViewController.swift</code> and modify like this:</p>
<div class="language-swift codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-swift codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token class-name">UIKit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ViewController</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">UIViewController</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token attribute atrule" style="color:#00a4db">@IBOutlet</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">weak</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> txtAge</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">UITextField</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token attribute atrule" style="color:#00a4db">@IBOutlet</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">weak</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> txtEstimatedSalary</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">UITextField</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token attribute atrule" style="color:#00a4db">@IBOutlet</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">weak</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> lblResult</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">UILabel</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">SocialNetworkAds</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">override</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">viewDidLoad</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">viewDidLoad</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">SocialNetworkAds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token attribute atrule" style="color:#00a4db">@IBOutlet</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token omit keyword" style="color:#00009f">_</span><span class="token plain"> sender</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txtAge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> salary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txtEstimatedSalary</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">age </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> salary </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> inputToPredict </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">SocialNetworkAdsInput</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Age</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Double</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">age</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">EstimatedSalary</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Double</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">salary</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">guard</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> outputPredicted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">prediction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> inputToPredict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fatalError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&quot;Unexpected runtime error.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">outputPredicted</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Purchased</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lblResult</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&quot;NO&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lblResult</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&quot;YES&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Now, run the app and enjoy!</strong></p>
<p><strong>Happy Coding! Good luck!</strong></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/machine-learning">machine learning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ios">ios</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/programming">programming</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/coreml">coreml</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item">
                  <a href="https://www.buymeacoffee.com/baolanlequang" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 30px !important;width: 117px !important;"></a>
                </li></ul></div><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://orcid.org/0000-0002-1199-4173" target="_blank" rel="noopener noreferrer" class="footer__link-item">ORCID<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://scholar.google.com/citations?user=zzkYTugAAAAJ&amp;hl=en" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Scholar<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.researchgate.net/profile/Lan-Le-7" target="_blank" rel="noopener noreferrer" class="footer__link-item">ResearchGate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">FAQ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/privacy">Privacy Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 baolan2005. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>