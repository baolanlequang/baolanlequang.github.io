"use strict";(self.webpackChunkbaolan_2005_web=self.webpackChunkbaolan_2005_web||[]).push([[894],{6042:e=>{e.exports=JSON.parse('{"blogPosts":[{"id":"using-core-ml-in-ios-from-a-to-z","metadata":{"permalink":"/blog/using-core-ml-in-ios-from-a-to-z","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2017-10-19-coreml-in-ios/index.md","source":"@site/blog/2017-10-19-coreml-in-ios/index.md","title":"Using Core ML in iOS from A to Z","description":"Core ML (Core Machine Learning) has been released by Apple in iOS 11. There are many articles about \u201cHow to using Core ML in iOS\u201d. However, in those articles, authors just told \u201cHow to USING the created model\u201d but they didn\u2019t talk \u201cHow to CREATE a model\u201d, so I write this article to introduce how to using Core ML from scratch, include how to create a model by yourself.","date":"2017-10-19T00:00:00.000Z","formattedDate":"October 19, 2017","tags":[{"label":"machine learning","permalink":"/blog/tags/machine-learning"},{"label":"ios","permalink":"/blog/tags/ios"},{"label":"programming","permalink":"/blog/tags/programming"},{"label":"coreml","permalink":"/blog/tags/coreml"}],"readingTime":3.725,"hasTruncateMarker":false,"authors":[{"name":"Lan Le","title":"Software engineer","url":"https://baolan2005.com","imageURL":"https://avatars.githubusercontent.com/u/9006482?v=4","key":"baolan"}],"frontMatter":{"slug":"using-core-ml-in-ios-from-a-to-z","title":"Using Core ML in iOS from A to Z","authors":["baolan"],"tags":["machine learning","ios","programming","coreml"]},"unlisted":false},"content":"Core ML (Core Machine Learning) has been released by Apple in iOS 11. There are many articles about \u201cHow to using Core ML in iOS\u201d. However, in those articles, authors just told \u201cHow to USING the created model\u201d but they didn\u2019t talk \u201cHow to CREATE a model\u201d, so I write this article to introduce how to using Core ML from scratch, include how to create a model by yourself.\\n\\nLet\u2019s start!\\n\\nYou can download the dataset that I use in this article [here](https://drive.google.com/file/d/0BycvTb1uT3G0M0F5czA4YkVCcnc/view?usp=sharing)\\n\\n## I. The dataset\\n\\nIn this dataset, we have 5 fields: UserID, Gender, Age, EstimatedSalary, Purchased. From this dataset, I want to create a simple DSS (Decision Support System) is: *Decide to purchase or not by using Age and Estimated Salary.*\\n\\n## II. Create training model\\n\\n### 1. Preparing\\n\\n#### 1.1. Python\\n\\nCheck your python version by using this command:\\n\\n```python \u2014 version```\\n\\nThe reason we need to check python version because we need python version `2.7`, if your python is version above `3.0`, you need to install python version `2.7`.\\n\\n**Why?** I\u2019ll talk in next section.\\n\\n#### 1.2. Install coremltools\\n\\nApple has provided a tool has name `coremltools` to convert a model has been created by python to model that can use in iOS.\\n\\ncoremltools only run with python version 2.7, that is the reason I told you install python 2.7 in previous section. In past, my machine has python 3.6 so I can\u2019t using coremltools.\\n\\nIf your machine only has python 2.7, just open the terminal and enter:\\n\\n```pip install coremltools```\\n\\nIf your machine has both python 3.x and python 2.7, open the terminal and enter:\\n\\n```sudo pip2 install coremltools```\\n\\nFor more details about install [coremltools](https://apple.github.io/coremltools/)\\n\\n#### 1.3. Install other packages for machine learning\\n\\nDepend of your machine learning method, you need other packages, just visit [https://apple.github.io/coremltools/](https://apple.github.io/coremltools/) for more details.\\n\\nIn this article, we need these packages: `sklearn`, `numpy`, `pandas` (Google for how to install these packages).\\n\\n**Note: Install these packages with python 2.7**\\n\\n### 2. Create the model by python\\n\\nFor example, I use Linear SVM and I create a python file has name svm.py with content:\\n\\n```python\\nimport numpy as np\\nimport pandas as pd\\nimport pickle\\n```\\n\\nTo read dataset from dataset file, continue with svm.py:\\n\\n```python\\n# Import dataset\\ndataset = pd.read_csv(\u2018Social_Network_Ads.csv\u2019);\\n# Read data from Age, EstimatedSalary\\nX = dataset.iloc[:, [2,3]].values\\n# Read data from Purchased\\ny = dataset.iloc[:, 4].values\\n```\\n\\nBecause values of Age and EstimatedSalary have a large gap so we need to standardize them to a same field to avoid wrong result.\\n\\n**Why? I couldn\'t answer here because it\'s about another domain: `MACHINE LEARNING`. So you need to read about machine learning to understand why.**\\n\\nContinue with svm.py:\\n\\n```python\\n# Feature Scaling\\nfrom sklearn.preprocessing import StandardScaler\\nsc = StandardScaler()\\nX = sc.fit_transform(X)\\n#Create the classifier\\nfrom sklearn import svm\\nclasssifier = svm.SVC(kernel=\u2019linear\u2019, C=1.0)\\nclasssifier.fit(X,y)\\n#save the model to disk\\nfrom sklearn.externals import joblib\\nfilename = \u2018Social_Network_Ads_model.sav\u2019\\npickle.dump(classsifier, open(filename, \u2018wb\u2019))\\n```\\n\\nNow, open your terminal and enter:\\n\\n```python svm.py```\\n\\nIf you have both python 3.x and python 2.7:\\n\\n```python2.7 svm.py```\\n\\n### 3. Create model for Core ML\\n\\nCreate another file has name extract_model.py with content:\\n\\n```python\\nimport coremltools\\nfrom sklearn.externals import joblib\\n#Load the created model\\nclassifier = joblib.load(\u2018Social_Network_Ads_model.sav\u2019)\\n#Convert the created model to Core ML model\\ncoremlModel = coremltools.converters.sklearn.convert(classifier, [\u201cAge\u201d,\u201dEstimatedSalary\u201d],\u201dPurchased\u201d)\\n# Save the converted model\\ncoremlModel.save(\u2018SocialNetworkAds.mlmodel\u2019)\\n```\\n\\n## III. Using the model\\n\\nI create a demo project has name `DemoAI` look like:\\n\\n![DemoAI screenshot](./screenshot_1.webp)\\n\\nDrag and drop file SocialNetworkAds.mlmodel to project, select this file we will see:\\n\\n![Xcode screenshot](./screenshot_2.webp)\\n\\nLook at section `Model Class`, check the Target Membership box if you don\u2019t see the message `Swift generated source`\\n\\n![Xcode screenshot 2](./screenshot_3.webp)\\n\\nXcode will generate a Object with name is the name of model file that we have imported to project.\\n\\nOpen `ViewController.swift` and modify like this:\\n\\n```swift\\nimport UIKit\\nclass ViewController: UIViewController {\\n  @IBOutlet weak var txtAge: UITextField!\\n  @IBOutlet weak var txtEstimatedSalary: UITextField!\\n  @IBOutlet weak var lblResult: UILabel!\\n\\n  var model: SocialNetworkAds!\\n\\n  override func viewDidLoad() {\\n    super.viewDidLoad()\\n\\n    model = SocialNetworkAds()\\n  }\\n\\n  @IBOutlet func predict(_ sender: Any) {\\n    let age = self.txtAge.text\\n    let salary = self.txtEstimatedSalary.text\\n    if (age != \\"\\" && salary !== \\"\\") {\\n      let inputToPredict = SocialNetworkAdsInput(Age: (Double(age!))!, EstimatedSalary: (Double(salary!))!)\\n      guard let outputPredicted = try? model.prediction(input: inputToPredict) else {\\n        fatalError(\\"Unexpected runtime error.\\")\\n      }\\n\\n      if (outputPredicted.Purchased == 0) {\\n        self.lblResult.text = \\"NO\\"\\n      } else {\\n        elf.lblResult.text = \\"YES\\"\\n      }\\n    }\\n  }\\n}\\n```\\n\\n**Now, run the app and enjoy!**\\n\\n**Happy Coding! Good luck!**"}]}')}}]);